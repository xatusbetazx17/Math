<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Algebra Master: Ultimate Practice Suite</title>
<style>
  :root {
    --bg: #0f172a;
    --card-bg: #1e293b;
    --text: #f1f5f9;
    --text-muted: #94a3b8;
    --primary: #38bdf8;
    --primary-hover: #0ea5e9;
    --success: #22c55e;
    --error: #ef4444;
    --border: #334155;
  }

  * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
  
  body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
    background-color: var(--bg);
    color: var(--text);
    margin: 0;
    padding: 0;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
  }

  .container {
    max-width: 800px;
    margin: 0 auto;
    padding: 20px;
    width: 100%;
    flex: 1;
  }

  /* --- TYPOGRAPHY --- */
  h1 { text-align: center; color: var(--primary); margin-bottom: 5px; font-size: 1.8rem; }
  h2 { font-size: 1.2rem; margin-top: 0; color: var(--text-muted); text-align: center; font-weight: 400; }
  .tag { background: #334155; color: #cbd5e1; padding: 2px 8px; border-radius: 12px; font-size: 0.75rem; text-transform: uppercase; letter-spacing: 0.5px; }

  /* --- CARDS --- */
  .card {
    background: var(--card-bg);
    border-radius: 16px;
    padding: 24px;
    box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.3);
    border: 1px solid var(--border);
    margin-bottom: 20px;
    animation: fadeIn 0.3s ease-out;
  }

  /* --- FORMS & INPUTS --- */
  .control-group { margin-bottom: 20px; }
  label { display: block; margin-bottom: 8px; font-weight: 600; color: var(--text); }
  select, input {
    width: 100%;
    padding: 12px 16px;
    background: #0f172a;
    border: 2px solid var(--border);
    border-radius: 10px;
    color: white;
    font-size: 1rem;
    transition: border-color 0.2s;
  }
  select:focus, input:focus { outline: none; border-color: var(--primary); }

  /* --- BUTTONS --- */
  .btn {
    display: inline-flex; justify-content: center; align-items: center;
    width: 100%; padding: 14px; border-radius: 12px;
    font-size: 1rem; font-weight: 700; border: none; cursor: pointer;
    transition: transform 0.1s, opacity 0.2s;
    margin-top: 10px;
  }
  .btn:active { transform: scale(0.98); }
  .btn-primary { background: var(--primary); color: #0f172a; }
  .btn-secondary { background: #334155; color: white; margin-top: 0; }
  .btn-outline { background: transparent; border: 2px solid var(--border); color: var(--text-muted); }
  .btn:disabled { opacity: 0.5; cursor: not-allowed; }

  .btn-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 20px; }

  /* --- QUIZ UI --- */
  .progress-bar {
    height: 6px; background: #334155; border-radius: 3px; margin-bottom: 20px; overflow: hidden;
  }
  .progress-fill { height: 100%; background: var(--primary); width: 0%; transition: width 0.3s ease; }

  .question-box { font-size: 1.15rem; line-height: 1.6; margin-bottom: 20px; }
  .math-display { font-family: 'Courier New', monospace; background: rgba(0,0,0,0.3); padding: 4px 8px; border-radius: 4px; }

  .options-grid { display: flex; flex-direction: column; gap: 10px; }
  .option-label {
    display: flex; align-items: flex-start; padding: 16px;
    background: #0f172a; border: 2px solid var(--border); border-radius: 12px;
    cursor: pointer; transition: all 0.2s;
  }
  .option-label:hover { border-color: var(--text-muted); }
  .option-label.selected { border-color: var(--primary); background: rgba(56, 189, 248, 0.1); }
  .option-label input { display: none; }
  .option-circle {
    width: 24px; height: 24px; border-radius: 50%; border: 2px solid var(--text-muted);
    margin-right: 12px; flex-shrink: 0; display: flex; align-items: center; justify-content: center;
  }
  .option-label.selected .option-circle { border-color: var(--primary); background: var(--primary); }
  .option-text { flex: 1; }

  /* --- FEEDBACK --- */
  .feedback { margin-top: 20px; padding: 16px; border-radius: 12px; display: none; }
  .feedback.correct { background: rgba(34, 197, 94, 0.15); border: 1px solid var(--success); color: #86efac; }
  .feedback.incorrect { background: rgba(239, 68, 68, 0.15); border: 1px solid var(--error); color: #fca5a5; }
  .explanation { margin-top: 10px; font-size: 0.95rem; opacity: 0.9; border-top: 1px solid rgba(255,255,255,0.1); padding-top: 10px; }

  /* --- UTILS --- */
  .hidden { display: none !important; }
  .text-center { text-align: center; }
  
  @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

  /* MATH FORMATTING */
  sup { font-size: 0.7em; vertical-align: super; }
  .frac { display: inline-block; vertical-align: middle; text-align: center; font-size: 0.9em; }
  .frac span { display: block; padding: 0 2px; }
  .frac span.bottom { border-top: 1px solid white; }
</style>
</head>
<body>

<div class="container">
  <h1>Algebra Master</h1>
  <h2>Interactive Practice Suite</h2>

  <div id="menuView" class="card">
    <div class="control-group">
      <label>Select Practice Mode</label>
      <select id="modeSelect">
        <optgroup label="Infinite Practice (Recommended)">
          <option value="infinite" selected>‚ôæÔ∏è Infinite Generator (10,000+ Variations)</option>
        </optgroup>
        <optgroup label="Official Questions (Form 2/B)">
          <option value="practice1">Practice #1 (Form 2)</option>
          <option value="practice2">Practice #2 (Form 2B)</option>
          <option value="finalreview">Final Review (Practice 3)</option>
          <option value="bootcamp">Boot Camp / Exit Exam</option>
          <option value="all">Mix All Official Tests</option>
        </optgroup>
      </select>
    </div>

    <div class="control-group">
      <label>Difficulty / Length</label>
      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
        <select id="diffSelect">
          <option value="standard">Standard</option>
          <option value="hard">Hard Mode (Fractions/Negatives)</option>
        </select>
        <input type="number" id="qCount" value="10" min="1" max="50" placeholder="Qty">
      </div>
    </div>

    <button class="btn btn-primary" onclick="App.start()">Start Practice ‚ñ∂</button>
  </div>

  <div id="quizView" class="hidden">
    <div class="progress-bar"><div class="progress-fill" id="progressFill"></div></div>
    
    <div class="card">
      <div style="display:flex; justify-content:space-between; margin-bottom:15px;">
        <span class="tag" id="qTag">GENERATED</span>
        <span class="tag" id="qCountDisplay">1/10</span>
      </div>
      
      <div class="question-box" id="qText"></div>
      
      <div class="options-grid" id="optionsArea"></div>

      <div id="feedbackArea" class="feedback"></div>

      <div class="btn-grid">
        <button id="checkBtn" class="btn btn-primary" onclick="App.check()">Check Answer</button>
        <button id="nextBtn" class="btn btn-secondary" onclick="App.next()" disabled>Next ‚ùØ</button>
      </div>
    </div>
    
    <button class="btn btn-outline" onclick="App.reset()">Exit to Menu</button>
  </div>

  <div id="resultsView" class="card hidden text-center">
    <h2 style="color: white; margin-bottom: 20px;">Session Complete!</h2>
    <div style="font-size: 4rem; font-weight: bold; margin-bottom: 10px;" id="finalScore"></div>
    <p style="color: var(--text-muted); margin-bottom: 30px;">Correct Answers</p>
    
    <div id="masteryMessage" style="margin-bottom: 30px; font-weight: bold; color: var(--primary);"></div>

    <button class="btn btn-primary" onclick="App.reset()">Back to Menu</button>
  </div>
</div>

<script>
/**
 * --- STATIC DATABASE (Official Questions) ---
 * Consolidated from User provided PDFs and Context
 */
const DB = {
  practice1: [
    {q:"Simplify: -5x‚Å¥(-6x - 7)", a:"30x‚Åµ + 35x‚Å¥", c:["65x‚Å∂","30x + 35","30x¬≥ - 7"], e:"Distribute -5x‚Å¥ to both terms:<br>(-5x‚Å¥)(-6x) = 30x‚Åµ<br>(-5x‚Å¥)(-7) = +35x‚Å¥."},
    {q:"Solve: 4(2z - 2) = 7(z + 4)", a:"36", c:["20","24","-20"], e:"1. Distribute: 8z - 8 = 7z + 28<br>2. Subtract 7z: z - 8 = 28<br>3. Add 8: z = 36."},
    {q:"Solve: 2/5 x - 1/3 x = 4", a:"60", c:["120","-60","30"], e:"Common denominator is 15.<br>(6/15)x - (5/15)x = 4<br>(1/15)x = 4<br>Multiply by 15: x = 60."},
    {q:"A factor of x¬≤ - 4x - 21 is", a:"(x - 7)", c:["(x + 3)","(x + 7)","(x + 8)"], e:"Find numbers that multiply to -21 and add to -4.<br>The numbers are -7 and 3.<br>Factors: (x-7)(x+3)."},
    {q:"Solve: -7x + 4 + 8x = 0", a:"{-4}", c:["{4}","{0.3}","{3.25}"], e:"Combine like terms: x + 4 = 0<br>Subtract 4: x = -4."},
    {q:"If 10x¬≤ + 8y, evaluate for x=2, y=3", a:"64", c:["360","106","424"], e:"10(2)¬≤ + 8(3)<br>= 10(4) + 24<br>= 40 + 24 = 64."},
    {q:"Solve for y: (x+y)/(4x-14) given x=5, y=3", a:"4/3", c:["5/6","2/5","8/51"], e:"Plug in: (5+3)/(20-14) = 8/6 = 4/3."},
    {q:"The product of -3 and 7, subtracted from -4", a:"17", c:["-25","84","-7"], e:"Product: -3 * 7 = -21.<br>Subtracted from -4: -4 - (-21)<br>= -4 + 21 = 17."},
    {q:"Simplify: (2x¬≤ ‚Ä¢ 24)/(4 ‚Ä¢ x¬≥)", a:"12/x", c:["48x¬≤/4x¬≥","12x","12x¬≤"], e:"(48x¬≤)/(4x¬≥) = 12 * x^(2-3) = 12x‚Åª¬π = 12/x."},
    {q:"Simplify: -3‚àö6 + 9‚àö54", a:"24‚àö6", c:["30‚àö6","-24‚àö6","6‚àö6"], e:"‚àö54 = ‚àö(9‚Ä¢6) = 3‚àö6.<br>So 9(3‚àö6) = 27‚àö6.<br>-3‚àö6 + 27‚àö6 = 24‚àö6."}
  ],
  practice2: [
    {q:"Simplify: -10x‚Å¥(10x - 12)", a:"-100x‚Åµ + 120x‚Å¥", c:["-100x + 120","20x¬≤","-100x‚Åµ - 12"], e:"Distribute -10x‚Å¥."},
    {q:"Solve: 2(2z - 2) = 3(z + 2)", a:"10", c:["-2","2","4"], e:"4z - 4 = 3z + 6<br>z - 4 = 6<br>z = 10."},
    {q:"Factor: x¬≤ - 5x - 66", a:"(x - 11)", c:["(x + 11)","(x - 5)","(x - 6)"], e:"Multiplies to -66, adds to -5: -11 and 6.<br>Factors: (x-11)(x+6)."},
    {q:"Solve: 6x + 10 - 5x = 0", a:"{-10}", c:["{10}","{-0.7}","{-1.3}"], e:"x + 10 = 0 -> x = -10."},
    {q:"Simplify: -2‚àö3 - 4‚àö27", a:"-14‚àö3", c:["14‚àö3","-10‚àö3","-6‚àö3"], e:"‚àö27 = 3‚àö3.<br>So 4‚àö27 = 12‚àö3.<br>-2‚àö3 - 12‚àö3 = -14‚àö3."},
    {q:"Equation of line through (2,5) and (0,8)", a:"y = -3/2 x + 8", c:["y = 3/2 x + 8","y = -1/8 x + 8","y = 3/8 x + 8"], e:"y-intercept is 8 (from (0,8)).<br>Slope = (8-5)/(0-2) = 3/-2 = -1.5."},
    {q:"Solve system: x+3y=2, 3x+2y=-1", a:"(-1, 1)", c:["(1, 0)","(0, 0)","(1, -1)"], e:"Multiply top by -3: -3x - 9y = -6.<br>Add to bottom: -7y = -7 -> y=1.<br>x + 3(1)=2 -> x=-1."},
    {q:"Simplify: (17a‚Å¥ - 11a¬≥) - (10a‚Å¥ - 13a¬≥)", a:"7a‚Å¥ + 2a¬≥", c:["9a‚Å∑","7a‚Å¥ - 24a¬≥","27a‚Å¥"], e:"Combine like terms:<br>17a‚Å¥ - 10a‚Å¥ = 7a‚Å¥<br>-11a¬≥ - (-13a¬≥) = -11a¬≥ + 13a¬≥ = 2a¬≥."}
  ],
  finalreview: [
    {q:"Simplify: -5(x - 3)", a:"-5x + 15", c:["-5x - 15","5x - 15","5x + 15"], e:"Distribute -5: (-5)(x) + (-5)(-3) = -5x + 15."},
    {q:"Factor: 4x¬≤y + 8y¬≤", a:"4y(x¬≤ + 2y)", c:["y(4x¬≤ + 8y)","4x(y + 2y)","4xy(1 + 2y)"], e:"GCF is 4y."},
    {q:"Evaluate x - 2xy¬≤ for x = -1, y = -4", a:"31", c:["-17","15","-33"], e:"-1 - 2(-1)(16) = -1 + 32 = 31."},
    {q:"Solve: P = 2L + 2W for L", a:"L = (P-2W)/2", c:["L = P - W","L = d - 2W","L = (P-W)/2"], e:"Subtract 2W, divide by 2."},
    {q:"Solve system: x+9y=9, 7x-5y=-5", a:"(0, 1)", c:["(1, 0)","(1, 1)","(0, 0)"], e:"If x=0, 9y=9->y=1. Check: 7(0)-5(1)=-5."},
    {q:"Solve: x¬≤ - x = 56", a:"{-7, 8}", c:["{1, 56}","{-7, -8}","{7, 8}"], e:"x¬≤ - x - 56 = 0<br>(x-8)(x+7)=0."},
    {q:"Evaluate (3x+7)/(14-2y) for x=9, y=6", a:"17", c:["39","34","14"], e:"(27+7)/(14-12) = 34/2 = 17."}
  ],
  bootcamp: [
    {q:"Evaluate: 8 - 1 + 3‚Åª¬π", a:"22/3", c:["7","24/11","8"], e:"7 + 1/3 = 21/3 + 1/3 = 22/3."},
    {q:"Solve: y¬≤ = 25y", a:"{0, 25}", c:["{-5, 5}","{25}","{0, 5}"], e:"y¬≤ - 25y = 0<br>y(y-25)=0<br>y=0 or y=25."},
    {q:"Solve: x¬≤ - x = 20", a:"{-4, 5}", c:["{1, 20}","{4, 5}","{-4, -5}"], e:"x¬≤ - x - 20 = 0<br>(x-5)(x+4)=0."},
    {q:"Factor: x¬≤ + 16x + 64", a:"(x + 8)¬≤", c:["(x - 8)¬≤","(x+8)(x-8)","Prime"], e:"Perfect square trinomial: (x+8)(x+8)."},
    {q:"Find product: (4x + 8)(x + 5)", a:"4x¬≤ + 28x + 40", c:["4x¬≤ + 40x + 28","4x¬≤ + 26x + 40","4x¬≤ + 28x + 28"], e:"FOIL: 4x¬≤ + 20x + 8x + 40<br>= 4x¬≤ + 28x + 40."},
    {q:"Solve for C: F = 9/5 C + 32", a:"C = 5/9 (F - 32)", c:["C = (F-32)/9","C = 5/(F-32)","C = 9/5 (F-32)"], e:"Subtract 32, then multiply by 5/9."}
  ]
};

/**
 * --- INFINITE GENERATOR ENGINE ---
 * Creates new Algebra problems on the fly.
 */
const Generator = {
  randInt: (min, max) => Math.floor(Math.random() * (max - min + 1)) + min,
  
  // 1. LINEAR EQUATIONS: ax + b = c
  linearEq: (diff) => {
    let a = Generator.randInt(2, diff === 'hard' ? 9 : 5);
    let x = Generator.randInt(-9, 9);
    let b = Generator.randInt(-15, 15);
    let c = a * x + b;
    let wrong = [x+1, -x, x-2];
    
    return {
      q: `Solve for x: ${a}x ${b >= 0 ? '+' : ''}${b} = ${c}`,
      a: x.toString(),
      c: wrong.map(w => w.toString()),
      e: `1. Subtract ${b} from both sides: ${a}x = ${c - b}<br>2. Divide by ${a}: x = ${x}`
    };
  },

  // 2. SYSTEMS OF EQUATIONS
  system: (diff) => {
    let x = Generator.randInt(1, 5);
    let y = Generator.randInt(1, 5);
    // Eq 1: x + y = Sum
    let s = x + y;
    // Eq 2: x - y = Diff
    let d = x - y;
    
    return {
      q: `Solve the system:<br>x + y = ${s}<br>x - y = ${d}`,
      a: `(${x}, ${y})`,
      c: [`(${y}, ${x})`, `(${x+1}, ${y})`, `(${x}, ${y-1})`],
      e: `Add the two equations:<br>(x + x) + (y - y) = ${s} + ${d}<br>2x = ${s+d} ‚Üí x = ${x}<br>Substitute back: ${x} + y = ${s} ‚Üí y = ${y}`
    };
  },

  // 3. FACTORING QUADRATICS: x^2 + bx + c
  factoring: (diff) => {
    let n1 = Generator.randInt(1, diff === 'hard' ? 9 : 6);
    let n2 = Generator.randInt(1, diff === 'hard' ? 9 : 6);
    // Randomize signs
    if (Math.random() > 0.5) n1 *= -1;
    if (Math.random() > 0.5) n2 *= -1;

    let b = n1 + n2;
    let c = n1 * n2;
    
    let formatNum = (n) => n > 0 ? `+ ${n}` : `- ${Math.abs(n)}`;
    
    return {
      q: `Factor completely: x¬≤ ${formatNum(b)}x ${formatNum(c)}`,
      a: `(x ${formatNum(n1)})(x ${formatNum(n2)})`.replace(/\s/g, ''),
      c: [
        `(x ${formatNum(-n1)})(x ${formatNum(n2)})`.replace(/\s/g, ''),
        `(x ${formatNum(n1)})(x ${formatNum(-n2)})`.replace(/\s/g, ''),
        "Prime"
      ],
      e: `Find two numbers that multiply to ${c} and add to ${b}.<br>The numbers are ${n1} and ${n2}.`
    };
  },
  
  // 4. RADICALS
  radicals: (diff) => {
    let squares = [4, 9, 16, 25, 36, 49, 64, 81, 100];
    let sq = squares[Generator.randInt(0, diff==='hard'?8:4)];
    let rem = Generator.randInt(2, 5);
    let val = sq * rem;
    let root = Math.sqrt(sq);
    
    return {
      q: `Simplify: ‚àö${val}`,
      a: `${root}‚àö${rem}`,
      c: [`${rem}‚àö${root}`, `${root*2}‚àö${rem}`, `${root}‚àö${val}`],
      e: `‚àö${val} = ‚àö( ${sq} ‚Ä¢ ${rem} ) = ${root}‚àö${rem}`
    };
  },

  // 5. EXPONENTS
  exponents: (diff) => {
    let base = Generator.randInt(2, 5);
    let exp = Generator.randInt(2, 4);
    let val = Math.pow(base, exp);
    
    // Negative exponent question
    if (diff === 'hard' || Math.random() > 0.5) {
      return {
        q: `Evaluate: ${base}<sup>-${exp}</sup>`,
        a: `1/${val}`,
        c: [`-${val}`, `${val}`, `1/${base*2}`],
        e: `Negative exponent rule: x‚Åª‚Åø = 1/x‚Åø.<br>So ${base}<sup>-${exp}</sup> = 1/${base}<sup>${exp}</sup> = 1/${val}.`
      };
    }
    
    // Product rule
    let e2 = Generator.randInt(2, 5);
    return {
      q: `Simplify: x<sup>${exp}</sup> ‚Ä¢ x<sup>${e2}</sup>`,
      a: `x<sup>${exp+e2}</sup>`,
      c: [`x<sup>${exp*e2}</sup>`, `2x<sup>${exp+e2}</sup>`, `x<sup>${Math.abs(exp-e2)}</sup>`],
      e: `Add exponents when multiplying same bases: ${exp} + ${e2} = ${exp+e2}.`
    };
  }
};

/**
 * --- MAIN APP LOGIC ---
 */
const App = {
  queue: [],
  index: 0,
  score: 0,
  
  start: () => {
    const mode = document.getElementById('modeSelect').value;
    const diff = document.getElementById('diffSelect').value;
    let count = parseInt(document.getElementById('qCount').value) || 10;
    
    App.queue = [];
    App.score = 0;
    App.index = 0;

    // 1. GENERATE OR LOAD QUESTIONS
    if (mode === 'infinite') {
      const types = ['linearEq', 'system', 'factoring', 'radicals', 'exponents'];
      for (let i = 0; i < count; i++) {
        const type = types[Math.floor(Math.random() * types.length)];
        const q = Generator[type](diff);
        App.queue.push(App.formatQuestion(q, 'Generated'));
      }
    } else {
      let pool = [];
      if (mode === 'all') {
        Object.keys(DB).forEach(key => pool = pool.concat(DB[key]));
      } else {
        pool = DB[mode] || [];
      }
      // Shuffle static pool
      pool.sort(() => Math.random() - 0.5);
      // Slice to count
      pool = pool.slice(0, count);
      
      App.queue = pool.map(q => App.formatQuestion(q, 'Official'));
    }

    if(App.queue.length === 0) {
      alert("No questions available for this selection.");
      return;
    }

    // UI Switch
    document.getElementById('menuView').classList.add('hidden');
    document.getElementById('resultsView').classList.add('hidden');
    document.getElementById('quizView').classList.remove('hidden');
    App.render();
  },

  formatQuestion: (qData, tag) => {
    // Shuffle choices
    let allOpts = [qData.a, ...qData.c];
    allOpts.sort(() => Math.random() - 0.5);
    return {
      text: qData.q,
      correct: qData.a,
      options: allOpts,
      explanation: qData.e,
      tag: tag
    };
  },

  render: () => {
    const q = App.queue[App.index];
    
    // Header Info
    document.getElementById('qTag').innerText = q.tag;
    document.getElementById('qCountDisplay').innerText = `${App.index + 1}/${App.queue.length}`;
    document.getElementById('progressFill').style.width = `${((App.index) / App.queue.length) * 100}%`;

    // Content
    document.getElementById('qText').innerHTML = q.text;
    const optsArea = document.getElementById('optionsArea');
    optsArea.innerHTML = '';

    q.options.forEach(opt => {
      const el = document.createElement('label');
      el.className = 'option-label';
      el.innerHTML = `
        <input type="radio" name="ans" value="${opt.replace(/"/g, '&quot;')}">
        <div class="option-circle"></div>
        <div class="option-text">${opt}</div>
      `;
      // Selection Logic
      el.onclick = () => {
        document.querySelectorAll('.option-label').forEach(l => l.classList.remove('selected'));
        el.classList.add('selected');
        el.querySelector('input').checked = true;
      };
      optsArea.appendChild(el);
    });

    // Reset State
    document.getElementById('feedbackArea').style.display = 'none';
    document.getElementById('checkBtn').style.display = 'inline-block';
    document.getElementById('nextBtn').disabled = true;
    document.getElementById('nextBtn').style.display = 'none';
  },

  check: () => {
    const selectedEl = document.querySelector('input[name="ans"]:checked');
    if (!selectedEl) return alert("Please select an answer.");

    const val = selectedEl.value;
    const q = App.queue[App.index];
    const isCorrect = val === q.correct;

    if (isCorrect) App.score++;

    // Show Feedback
    const fb = document.getElementById('feedbackArea');
    fb.style.display = 'block';
    fb.className = `feedback ${isCorrect ? 'correct' : 'incorrect'}`;
    fb.innerHTML = `
      <strong>${isCorrect ? '‚úÖ Correct!' : '‚ùå Incorrect'}</strong><br>
      The answer is: <b>${q.correct}</b>
      <div class="explanation">${q.explanation}</div>
    `;

    document.getElementById('checkBtn').style.display = 'none';
    document.getElementById('nextBtn').style.display = 'inline-block';
    document.getElementById('nextBtn').disabled = false;
  },

  next: () => {
    if (App.index < App.queue.length - 1) {
      App.index++;
      App.render();
    } else {
      App.finish();
    }
  },

  finish: () => {
    document.getElementById('quizView').classList.add('hidden');
    document.getElementById('resultsView').classList.remove('hidden');
    
    const pct = Math.round((App.score / App.queue.length) * 100);
    document.getElementById('finalScore').innerText = `${pct}%`;
    
    let msg = "";
    if(pct === 100) msg = "üèÜ Perfect Score! You are an Algebra Master!";
    else if(pct >= 80) msg = "Great job! You're ready for the exam.";
    else if(pct >= 60) msg = "Good effort. Review the explanations and try again.";
    else msg = "Keep practicing. Use the Infinite Mode to build skills.";
    
    document.getElementById('masteryMessage').innerText = msg;
  },

  reset: () => {
    document.getElementById('resultsView').classList.add('hidden');
    document.getElementById('quizView').classList.add('hidden');
    document.getElementById('menuView').classList.remove('hidden');
  }
};
</script>
</body>
</html>
