<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Hard Random Practice — MA025B</title>
<meta name="description" content="Harder randomized algebra practice with notebook-style steps and detailed wrong-answer feedback.">
<style>
  :root{--bg:#0b0e11;--card:#12161c;--ink:#e9edf1;--muted:#b8c1cc;--accent:#4da3ff;--line:#1f2a36;--ok:#19c37d;--bad:#ff5c5c;--warn:#ffd166}
  *{box-sizing:border-box} body{margin:0;background:var(--bg);color:var(--ink);font:16px/1.5 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial}
  header,main,footer{max-width:980px;margin:auto;padding:16px}
  h1{font-size:1.25rem;margin:0 0 8px}
  .card{background:var(--card);border:1px solid var(--line);border-radius:12px;padding:16px;margin:14px 0}
  .grid{display:grid;grid-template-columns:1fr;gap:12px} @media(min-width:760px){.grid{grid-template-columns:repeat(2,1fr)}}
  fieldset{border:1px solid var(--line);border-radius:10px;padding:10px} legend{color:var(--muted)}
  label{display:flex;gap:8px;align-items:center;margin:6px 0}
  input[type=number],input[type=text]{width:100%;max-width:200px;padding:8px;border-radius:8px;border:1px solid var(--line);background:#0f141a;color:var(--ink)}
  button{appearance:none;border:1px solid var(--line);background:#0e3a66;color:#eaf3ff;border-radius:8px;padding:10px 14px;cursor:pointer}
  button:hover{filter:brightness(1.08)}
  .qa{padding:12px;border:1px solid var(--line);border-radius:10px;background:#0f141a;margin:10px 0}
  .row{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
  .result{font-weight:700;margin-top:6px}.ok{color:var(--ok)} .bad{color:var(--bad)} .warn{color:var(--warn)}
  details{background:#0b1117;border:1px dashed var(--line);border-radius:10px;padding:10px;margin-top:6px}
  summary{cursor:pointer;color:var(--accent)} a{color:var(--accent)}
  code{background:#0b1016;border:1px solid #1f2a36;padding:0 .35rem;border-radius:6px}
</style>
</head>
<body>
<header>
  <h1>Hard Random Practice — Units 6–9++</h1>
  <p>Generate tough problems with full notebook‑style steps. <a href="index.html">Home</a> • <a href="practice_exam2.html">Exam 2</a></p>
</header>

<main>
  <section class="card">
    <div class="grid">
      <fieldset>
        <legend>Topics</legend>
        <label><input type="checkbox" class="topic" value="acfact" checked> Factoring trinomials (a≠1, ac‑method)</label>
        <label><input type="checkbox" class="topic" value="cts" checked> Completing the square</label>
        <label><input type="checkbox" class="topic" value="qf" checked> Quadratic formula</label>
        <label><input type="checkbox" class="topic" value="ratreq" checked> Rational equations (LCD + extraneous)</label>
        <label><input type="checkbox" class="topic" value="rad" checked> Radicals: simplify & rationalize</label>
        <label><input type="checkbox" class="topic" value="pld" checked> Polynomial long division</label>
        <label><input type="checkbox" class="topic" value="sys" checked> Systems (elimination, fractions)</label>
      </fieldset>
      <fieldset>
        <legend>Options</legend>
        <label>Questions <input id="count" type="number" min="3" max="25" value="10"></label>
        <div class="row">
          <button id="gen">Generate</button>
          <button id="clear">Reset</button>
        </div>
      </fieldset>
    </div>
  </section>

  <section id="quiz"></section>
</main>

<footer class="card">
  <p>Tips: show your work; compare to the step‑by‑step. If your form is correct but simplified differently, that still earns ✅.</p>
</footer>

<script>
function r(lo,hi){ return Math.floor(Math.random()*(hi-lo+1))+lo; }
function sgn(){ return Math.random()<.5? -1:1; }
function gcd(a,b){ a=Math.abs(a); b=Math.abs(b); while(b){ [a,b]=[b,a%b]; } return a||1; }
function simp(n,d){ const g=gcd(n,d); return [n/g, d/g]; }
function fracToText(n,d){ const sign=(n*d<0)?'-':''; [n,d]=[Math.abs(n),Math.abs(d)]; if(d===1) return sign+n; return sign + n + '/' + d; }
function sameNumberForm(u,v){ return u.replace(/\s+/g,'').replace(/^0\+?/,'')===v.replace(/\s+/g,''); }

function acFact(){
  const a=r(2,6), p=sgn()*r(1,9), q=sgn()*r(1,9);
  const b=a*q+p, c=p*q;
  const qf=`${a}x² ${b<0?'-':'+'} ${Math.abs(b)}x ${c<0?'-':'+'} ${Math.abs(c)}`;
  const steps=[
    `ac = ${a}·${c} = ${a*c}. Find two integers whose product is ${a*c} and sum is ${b}.`,
    `Split the middle term: ${a}x² + ${a*q}x + ${p}x ${c<0?'-':'+'} ${Math.abs(c)}.`,
    `Group: ${a}x(x ${q<0?'-':'+'} ${Math.abs(q)}) + ${p}(x ${q<0?'-':'+'} ${Math.abs(q)})`,
    `Factor common binomial → (x ${q<0?'-':'+'} ${Math.abs(q)})(${a}x ${p<0?'-':'+'} ${Math.abs(p)})`
  ];
  return {
    prompt:`Factor: ${qf}`,
    answer:`(x ${q<0?'-':'+'} ${Math.abs(q)})(${a}x ${p<0?'-':'+'} ${Math.abs(p)})`,
    check:(val)=>val.replace(/\s+/g,'').includes(`(x${q<0?'-':'+'}${Math.abs(q)})(`),
    whyWrong:`Use the ac‑method: product ${a*c} and sum ${b}; then group as shown.`,
    steps
  };
}

function completingSquare(){
  const h=sgn()*r(1,6), k=sgn()*r(0,10);
  // (x - h)^2 = k form
  const b=-2*h, c=h*h - k;
  const steps=[
    `Start: x² ${b<0?'-':'+'} ${Math.abs(b)}x ${c<0?'-':'+'} ${Math.abs(c)} = 0`,
    `Move constant: x² ${b<0?'-':'+'} ${Math.abs(b)}x = ${-c}`,
    `Complete the square: add (b/2)² = (${b}/2)² = ${h*h} to both sides`,
    `(x ${h<0?'+':'-'} ${Math.abs(h)})² = ${-c + h*h}`,
    `Solve: x = ${h} ± √(${ -c + h*h })`
  ];
  return {
    prompt:`Solve by completing the square: x² ${b<0?'-':'+'} ${Math.abs(b)}x ${c<0?'-':'+'} ${Math.abs(c)} = 0`,
    answer:`x = ${h} ± √(${ -c + h*h })`,
    check:(val)=>val.replace(/\s+/g,'').includes(`x=${h}±√(${ -c + h*h })`),
    whyWrong:`Complete the square using (b/2)²; write as (x${h<0?'+':'-'}${Math.abs(h)})² = ...`,
    steps
  };
}

function quadraticFormula(){
  // ax^2 + bx + c = 0 with integer roots sometimes
  const a=r(1,6), root1=sgn()*r(1,9), root2=sgn()*r(1,9);
  const b= -a*(root1+root2), c=a*root1*root2;
  const disc=b*b-4*a*c;
  const steps=[
    `Equation: ${a}x² ${b<0?'-':'+'} ${Math.abs(b)}x ${c<0?'-':'+'} ${Math.abs(c)} = 0`,
    `Use quadratic formula: x = (-b ± √(b² − 4ac))/(2a)`,
    `b² − 4ac = ${b*b} − 4·${a}·${c} = ${disc}`,
    `x = (${ -b } ± √${disc}) / ${2*a}`
  ];
  const ans=`x = (${ -b } ± √${disc}) / ${2*a}`;
  return {
    prompt:`Solve using quadratic formula: ${a}x² ${b<0?'-':'+'} ${Math.abs(b)}x ${c<0?'-':'+'} ${Math.abs(c)} = 0`,
    answer:ans,
    check:(val)=>val.replace(/\s+/g,'')===ans.replace(/\s+/g,''),
    whyWrong:`Plug a=${a}, b=${b}, c=${c} into the formula; be careful with signs.`,
    steps
  };
}

function rationalEquation(){
  // (ax+b)/m = (cx+d)/n
  const a=sgn()*r(1,6), b=sgn()*r(0,10), c=sgn()*r(1,6), d=sgn()*r(0,10), m=r(2,9), n=r(2,9);
  // choose integer solution
  const x=r(-6,6);
  const left = a*x + b, right = c*x + d;
  // Set equality so that (ax+b)/m = (cx+d)/n is true for chosen x
  // Adjust constants so equality holds:
  // we keep (ax+b)/m = (cx+d)/n -> choose d so equality holds for that x
  const d2 = Math.round(( (a*x + b)/m * n ) - c*x);
  const steps=[
    `(${a}x ${b<0?'-':'+'} ${Math.abs(b)})/${m} = (${c}x ${d2<0?'-':'+'} ${Math.abs(d2)})/${n}`,
    `Multiply both sides by lcm(${m},${n}) = ${m*n} to clear denominators.`,
    `${n}(${a}x ${b<0?'-':'+'} ${Math.abs(b)}) = ${m}(${c}x ${d2<0?'-':'+'} ${Math.abs(d2)})`,
    `${n*a}x ${ (n*b<0)?'-':'+' } ${Math.abs(n*b)} = ${m*c}x ${ (m*d2<0)?'-':'+' } ${Math.abs(m*d2)}`,
    `Collect x terms and constants to solve for x.`,
    `Check for extraneous: ensure denominators ≠ 0 (x ≠ values that make ${m} or ${n} zero — here constants, so OK).`
  ];
  return {
    prompt:`Solve the rational equation: (${a}x ${b<0?'-':'+'} ${Math.abs(b)})/${m} = (${c}x ${d2<0?'-':'+'} ${Math.abs(d2)})/${n}`,
    answer:`x = ${x}`,
    check:(val)=>val.replace(/\s+/g,'').toLowerCase()===('x='+x).replace(/\s+/g,'').toLowerCase() || val.trim()===''+x,
    whyWrong:`Clear denominators with LCM, collect like terms, and isolate x. Recheck your distribution signs.`,
    steps
  };
}

function radicals(){
  const k=r(2,12), t=r(2,6);
  // Simplify √(k^2 * t) -> k√t
  const rad=k*k*t;
  const steps=[
    `Simplify √${rad} = √(${k}²·${t}) = ${k}√${t}.`,
    `If t has square factors, continue factoring; otherwise it's simplified.`
  ];
  return {
    prompt:`Simplify: √${rad}`,
    answer:`${k}√${t}`,
    check:(val)=>val.replace(/\s+/g,'')===(`${k}√${t}`).replace(/\s+/g,''),
    whyWrong:`Look for perfect-square factors inside the radical: ${rad} = ${k}²·${t}.`,
    steps
  };
}

function polyLongDivision(){
  // (ax^3+bx^2+cx+d) ÷ (x - r) with integer remainder
  const r0=sgn()*r(1,6);
  const a=r(1,5), b=sgn()*r(0,9), c=sgn()*r(0,9), d=sgn()*r(0,9);
  const steps=[
    `Divide leading terms: (${a}x³)/(x) = ${a}x².`,
    `Multiply back by divisor (x - ${r0}) and subtract; repeat to get quotient and remainder.`,
    `Synthetic division can speed this up with root r=${r0}.`
  ];
  return {
    prompt:`Divide: (${a}x³ ${b<0?'-':'+'} ${Math.abs(b)}x² ${c<0?'-':'+'} ${Math.abs(c)}x ${d<0?'-':'+'} ${Math.abs(d)}) ÷ (x ${r0<0?'+':'-'} ${Math.abs(r0)})`,
    answer:`Quotient: ${a}x² + … (work shown in steps); Remainder: depends on coefficients`,
    check:()=>true, // manual check via steps
    whyWrong:`Follow polynomial long division or synthetic division carefully; align like powers.`,
    steps
  };
}

function systemFrac(){
  // ax + by = e,   cx + dy = f  with fractional coefficients
  const a=r(1,6), b=r(1,6), c=r(1,6), d=r(1,6);
  const x=r(-5,5), y=r(-5,5);
  const e=a*x + b*y, f=c*x + d*y;
  const steps=[
    `System: ${a}x + ${b}y = ${e},   ${c}x + ${d}y = ${f}`,
    `Eliminate (e.g., multiply top by ${c} and bottom by ${a}):`,
    `${c*a}x + ${c*b}y = ${c*e}`,
    `${a*c}x + ${a*d}y = ${a*f}`,
    `Subtract to eliminate x, solve for y, then back‑substitute to get x.`
  ];
  return {
    prompt:`Solve the system: ${a}x + ${b}y = ${e}  and  ${c}x + ${d}y = ${f}`,
    answer:`(x, y) = (${x}, ${y})`,
    check:(val)=>val.replace(/\s+/g,'').toLowerCase()===`(x,y)=(${x},${y})`.replace(/\s+/g,'').toLowerCase()
                 || val.replace(/\s+/g,'')===`${x},${y}`,
    whyWrong:`Use elimination with integer multipliers to avoid fractions; verify by substitution.`,
    steps
  };
}

const genByKey = { acfact:acFact, cts:completingSquare, qf:quadraticFormula, ratreq:rationalEquation, rad:radicals, pld:polyLongDivision, sys:systemFrac };

const quiz = document.getElementById('quiz');
document.getElementById('gen').addEventListener('click', ()=>{
  const chosen = [...document.querySelectorAll('.topic:checked')].map(e=>e.value);
  const n = Math.max(3, Math.min(25, +document.getElementById('count').value||10));
  if(!chosen.length){ alert('Pick at least one topic.'); return; }
  const items=[];
  for(let i=0;i<n;i++){ const key = chosen[i % chosen.length]; items.push(genByKey[key]()); }
  render(items);
});
document.getElementById('clear').addEventListener('click', ()=> quiz.innerHTML='');

function render(items){
  quiz.innerHTML = items.map((it,idx)=>`
    <article class="qa">
      <h3>Q${idx+1}</h3>
      <p>${it.prompt}</p>
      <div class="row">
        <label>Answer:
          <input type="text" id="ans${idx}" placeholder="e.g., x = 3  or  (x, y) = (2, -1)  or  (x + 2)(3x - 5)">
        </label>
        <button class="chk" data-i="${idx}">Check</button>
      </div>
      <div id="res${idx}" class="result" aria-live="polite"></div>
      <details><summary>Show steps</summary><ol>${(it.steps||[]).map(s=>`<li>${s}</li>`).join('')}</ol></details>
      <details><summary>Reveal exact answer</summary><p><code>${it.answer}</code></p></details>
    </article>
  `).join('');
  quiz.querySelectorAll('.chk').forEach(btn=>{
    btn.addEventListener('click', ()=>{
      const i = +btn.dataset.i, it = items[i];
      const user = (document.getElementById('ans'+i).value||'').trim();
      if(!user){ document.getElementById('res'+i).innerHTML = '<span class="warn">Type an answer first.</span>'; return; }
      const correct = (typeof it.answer==='string'? it.answer : String(it.answer));
      const eq = (it.check && typeof it.check==='function') ? it.check(user) : sameNumberForm(user, correct);
      document.getElementById('res'+i).innerHTML = eq
        ? '<span class="ok">Correct ✔</span>'
        : `<span class="bad">Not quite.</span> <br><span>Why: ${it.whyWrong}</span><br><span class="muted">Expected a form equivalent to: <code>${correct}</code></span>`;
    });
  });
}

/* PWA */
if('serviceWorker' in navigator){ navigator.serviceWorker.register('sw.js?ver=12').catch(()=>{}); }
</script>
</body>
</html>
